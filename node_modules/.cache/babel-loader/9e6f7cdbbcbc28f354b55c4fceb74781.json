{"ast":null,"code":"import _slicedToArray from \"/Users/ganlintian/Desktop/Hack20/workout-buddy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/ganlintian/Desktop/Hack20/workout-buddy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/ganlintian/Desktop/Hack20/workout-buddy/src/views/examples/Profile.js\";\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 50%;\\n  height: 50%;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  width: 100%;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  height: 100vh;\\n  width: 100%;\\n  display: flex;\\n  flex-direction: column;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport './App.css';\nimport io from \"socket.io-client\";\nimport Peer from \"simple-peer\";\nimport styled from \"styled-components\";\nimport { Col, Card, Button, CardBody } from \"reactstrap\";\nvar Container = styled.div(_templateObject());\nvar Row = styled.div(_templateObject2());\nvar Video = styled.video(_templateObject3());\n\nfunction App() {\n  var _this = this;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      yourID = _useState2[0],\n      setYourID = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      users = _useState4[0],\n      setUsers = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      stream = _useState6[0],\n      setStream = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      receivingCall = _useState8[0],\n      setReceivingCall = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      caller = _useState10[0],\n      setCaller = _useState10[1];\n\n  var _useState11 = useState(),\n      _useState12 = _slicedToArray(_useState11, 2),\n      callerSignal = _useState12[0],\n      setCallerSignal = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      callAccepted = _useState14[0],\n      setCallAccepted = _useState14[1];\n\n  var userVideo = useRef();\n  var partnerVideo = useRef();\n  var socket = useRef();\n  useEffect(function () {\n    socket.current = io.connect(\"/\");\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(function (stream) {\n      setStream(stream);\n\n      if (userVideo.current) {\n        userVideo.current.srcObject = stream;\n      }\n    });\n    socket.current.on(\"yourID\", function (id) {\n      setYourID(id);\n    });\n    socket.current.on(\"allUsers\", function (users) {\n      setUsers(users);\n    });\n    socket.current.on(\"hey\", function (data) {\n      setReceivingCall(true);\n      setCaller(data.from);\n      setCallerSignal(data.signal);\n    });\n  }, []);\n\n  function callPeer(id) {\n    var peer = new Peer({\n      initiator: true,\n      //if this person is initiator or not\n      trickle: false,\n      config: {\n        iceServers: [{\n          urls: \"stun:numb.viagenie.ca\",\n          username: \"sultan1640@gmail.com\",\n          credential: \"98376683\"\n        }, {\n          urls: \"turn:numb.viagenie.ca\",\n          username: \"sultan1640@gmail.com\",\n          credential: \"98376683\"\n        }]\n      },\n      stream: stream\n    });\n    peer.on(\"signal\", function (data) {\n      socket.current.emit(\"callUser\", {\n        userToCall: id,\n        signalData: data,\n        from: yourID\n      });\n    });\n    peer.on(\"stream\", function (stream) {\n      if (partnerVideo.current) {\n        partnerVideo.current.srcObject = stream;\n      }\n    });\n    socket.current.on(\"callAccepted\", function (signal) {\n      setCallAccepted(true);\n      peer.signal(signal); //send signal to the call receiver?\n    });\n  }\n\n  function acceptCall() {\n    setCallAccepted(true);\n    var peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream: stream\n    });\n    peer.on(\"signal\", function (data) {\n      socket.current.emit(\"acceptCall\", {\n        signal: data,\n        to: caller\n      });\n    });\n    peer.on(\"stream\", function (stream) {\n      partnerVideo.current.srcObject = stream;\n    });\n    peer.signal(callerSignal);\n  }\n\n  var UserVideo;\n\n  if (stream) {\n    UserVideo = /*#__PURE__*/React.createElement(Video, {\n      className: \"m-auto\",\n      playsInline: true,\n      muted: true,\n      ref: userVideo,\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 7\n      }\n    });\n  }\n\n  var PartnerVideo;\n\n  if (callAccepted) {\n    PartnerVideo = /*#__PURE__*/React.createElement(Video, {\n      playsInline: true,\n      ref: partnerVideo,\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 7\n      }\n    });\n  }\n\n  var incomingCall;\n\n  if (receivingCall) {\n    incomingCall = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }\n    }, caller, \" is calling you\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: acceptCall,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }\n    }, \"Accept\"));\n  }\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"header bg-gradient-info pb-2 pt-5 pt-8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"header-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xl: \"7\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    className: \"mt-3 ml-2 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, \"Your personal workout room\")), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, UserVideo, PartnerVideo), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Video, {\n    className: \"m-3\",\n    playsInline: true,\n    muted: true,\n    ref: userVideo,\n    autoPlay: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Video, {\n    className: \"m-3\",\n    playsInline: true,\n    muted: true,\n    ref: userVideo,\n    autoPlay: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 11\n    }\n  }, Object.keys(users).map(function (key) {\n    if (key === yourID) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.createElement(\"button\", {\n      onClick: function onClick() {\n        return callPeer(key);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }\n    }, \"Call \", key);\n  })), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, incomingCall), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-centered\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 15\n    }\n  }, \"Waiting for the other people to join...\")), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 15\n    }\n  }, \"Disconnect\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 15\n    }\n  }, \"Mute\")))), /*#__PURE__*/React.createElement(Col, {\n    xl: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CardBody, {\n    style: {\n      maxWidth: \"100vw\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    className: \"mt-3 ml-2 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 19\n    }\n  }, \"Today's workout instructions\")), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"iframe\", {\n    className: \"ml-5 mb-4\",\n    width: \"560\",\n    height: \"315\",\n    src: \"https://www.youtube.com/embed/GLy2rYHwUqY\",\n    frameborder: \"0\",\n    allow: \"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\",\n    allowfullscreen: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 17\n    }\n  })))), /*#__PURE__*/React.createElement(Card, {\n    className: \"mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    className: \"mt-3 ml-4 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 17\n    }\n  }, \"Remaining Time:\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"ml-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 17\n    }\n  }, \"24 minutes\")), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xl: \"12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 21\n    }\n  }, \"2:00\"))), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xl: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    outline: true,\n    color: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }, \"Start\")), /*#__PURE__*/React.createElement(Col, {\n    xl: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    outline: true,\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 21\n    }\n  }, \"Stop\")))))));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/ganlintian/Desktop/Hack20/workout-buddy/src/views/examples/Profile.js"],"names":["React","useEffect","useState","useRef","io","Peer","styled","Col","Card","Button","CardBody","Container","div","Row","Video","video","App","yourID","setYourID","users","setUsers","stream","setStream","receivingCall","setReceivingCall","caller","setCaller","callerSignal","setCallerSignal","callAccepted","setCallAccepted","userVideo","partnerVideo","socket","current","connect","navigator","mediaDevices","getUserMedia","audio","then","srcObject","on","id","data","from","signal","callPeer","peer","initiator","trickle","config","iceServers","urls","username","credential","emit","userToCall","signalData","acceptCall","to","UserVideo","PartnerVideo","incomingCall","Object","keys","map","key","maxWidth"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport './App.css';\r\nimport io from \"socket.io-client\";\r\nimport Peer from \"simple-peer\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Col,\r\n  Card,\r\n  Button,\r\n  CardBody\r\n} from \"reactstrap\";\r\n\r\nconst Container = styled.div`\r\n  height: 100vh;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Row = styled.div`\r\n  display: flex;\r\n  width: 100%;\r\n`;\r\n\r\nconst Video = styled.video`\r\n  width: 50%;\r\n  height: 50%;\r\n`;\r\n\r\nfunction App() {\r\n  const [yourID, setYourID] = useState(\"\");\r\n  const [users, setUsers] = useState({});\r\n  const [stream, setStream] = useState();\r\n  const [receivingCall, setReceivingCall] = useState(false);\r\n  const [caller, setCaller] = useState(\"\");\r\n  const [callerSignal, setCallerSignal] = useState();\r\n  const [callAccepted, setCallAccepted] = useState(false);\r\n\r\n  const userVideo = useRef();\r\n  const partnerVideo = useRef();\r\n  const socket = useRef();\r\n\r\n  useEffect(() => {\r\n    socket.current = io.connect(\"/\");\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {\r\n      setStream(stream);\r\n      if (userVideo.current) {\r\n        userVideo.current.srcObject = stream;\r\n      }\r\n    })\r\n\r\n    socket.current.on(\"yourID\", (id) => {\r\n      setYourID(id);\r\n    })\r\n    socket.current.on(\"allUsers\", (users) => {\r\n      setUsers(users);\r\n    })\r\n\r\n    socket.current.on(\"hey\", (data) => {\r\n      setReceivingCall(true);\r\n      setCaller(data.from);\r\n      setCallerSignal(data.signal);\r\n    })\r\n  }, []);\r\n\r\n  function callPeer(id) {\r\n    const peer = new Peer({\r\n      initiator: true, //if this person is initiator or not\r\n      trickle: false,\r\n      config: {\r\n\r\n        iceServers: [\r\n            {\r\n                urls: \"stun:numb.viagenie.ca\",\r\n                username: \"sultan1640@gmail.com\",\r\n                credential: \"98376683\"\r\n            },\r\n            {\r\n                urls: \"turn:numb.viagenie.ca\",\r\n                username: \"sultan1640@gmail.com\",\r\n                credential: \"98376683\"\r\n            }\r\n        ]\r\n    },\r\n      stream: stream,\r\n    });\r\n\r\n    peer.on(\"signal\", data => {\r\n      socket.current.emit(\"callUser\", { userToCall: id, signalData: data, from: yourID })\r\n    })\r\n\r\n    peer.on(\"stream\", stream => {\r\n      if (partnerVideo.current) {\r\n        partnerVideo.current.srcObject = stream;\r\n      }\r\n    });\r\n\r\n    socket.current.on(\"callAccepted\", signal => {\r\n      setCallAccepted(true);\r\n      peer.signal(signal); //send signal to the call receiver?\r\n    })\r\n\r\n  }\r\n\r\n  function acceptCall() {\r\n    setCallAccepted(true);\r\n    const peer = new Peer({\r\n      initiator: false,\r\n      trickle: false,\r\n      stream: stream,\r\n    });\r\n    peer.on(\"signal\", data => {\r\n      socket.current.emit(\"acceptCall\", { signal: data, to: caller })\r\n    })\r\n\r\n    peer.on(\"stream\", stream => {\r\n      partnerVideo.current.srcObject = stream;\r\n    });\r\n\r\n    peer.signal(callerSignal);\r\n  }\r\n\r\n  let UserVideo;\r\n  if (stream) {\r\n    UserVideo = (\r\n      <Video className=\"m-auto\" playsInline muted ref={userVideo} autoPlay />\r\n    );\r\n  }\r\n\r\n  let PartnerVideo;\r\n  if (callAccepted) {\r\n    PartnerVideo = (\r\n      <Video playsInline ref={partnerVideo} autoPlay />\r\n    );\r\n  }\r\n\r\n  let incomingCall;\r\n  if (receivingCall) {\r\n    incomingCall = (\r\n      <div>\r\n        <h1>{caller} is calling you</h1>\r\n        <button onClick={acceptCall}>Accept</button>\r\n      </div>\r\n    )\r\n  }\r\n  return (\r\n    <Container>\r\n        <div className=\"header bg-gradient-info pb-2 pt-5 pt-8\">\r\n            <div className=\"header-body\">\r\n              {/* Card stats */}\r\n            </div>\r\n       </div>\r\n      <Row>\r\n        <Col xl=\"7\">\r\n          <Row className=\"mt-3 ml-2 mb-2\">\r\n            <h1>Your personal workout room</h1>\r\n          </Row>\r\n          <Row>\r\n            {UserVideo}\r\n            {PartnerVideo}\r\n          </Row>\r\n          <Row>\r\n            <Video className=\"m-3\" playsInline muted ref={userVideo} autoPlay />\r\n            <Video className=\"m-3\" playsInline muted ref={userVideo} autoPlay />\r\n          </Row>\r\n          <Row>\r\n            {Object.keys(users).map(key => {\r\n              if (key === yourID) {\r\n                return null;\r\n              }\r\n              return (\r\n                <button onClick={() => callPeer(key)}>Call {key}</button>\r\n              );\r\n            })}\r\n          </Row>\r\n          <Row>\r\n            {incomingCall}\r\n          </Row>\r\n          <Row>\r\n            <Col>\r\n              <p className=\"text-centered\">Waiting for the other people to join...</p>\r\n            </Col>\r\n            <Col>\r\n              <Button color=\"info\">Disconnect</Button>\r\n              <Button color=\"danger\">Mute</Button>\r\n            </Col>\r\n          </Row>\r\n        </Col>\r\n        <Col xl=\"5\">\r\n            <Card className=\"mt-2\">\r\n              <CardBody style={{maxWidth: `100vw`}}>\r\n                <Row className=\"mt-3 ml-2 mb-2\">\r\n                  <p>Today's workout instructions</p>\r\n                </Row>\r\n                <Row>\r\n                <iframe className=\"ml-5 mb-4\" width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/GLy2rYHwUqY\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\r\n                </Row>\r\n\r\n\r\n              </CardBody>\r\n            </Card>\r\n            <Card className = \"mt-2\">\r\n              <Row className=\"mt-3 ml-4 mb-2\">\r\n                <h2>Remaining Time:</h2>\r\n                <p className=\"ml-3\">24 minutes</p>\r\n              </Row>\r\n              <Row>\r\n                  <Col xl=\"12\">\r\n                    <h2>2:00</h2>\r\n                  </Col>\r\n                </Row>\r\n              <Row>\r\n                  <Col xl=\"6\">\r\n                    <Button outline color=\"danger\">Start</Button>\r\n                  </Col>\r\n                  <Col xl=\"6\">\r\n                    <Button outline color=\"primary\">Stop</Button>\r\n                  </Col>\r\n                </Row>\r\n            </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}